## **1 .set** - 设置字符串键值对

```python
await redis_client.set(key, value, expire=None)
```

**含义**：设置一个字符串类型的键值对

**参数**：

- `key`: 键名（字符串）
- `value`: 值（可以是字符串、数字或简单对象）
- `expire`: 过期时间（秒），可选

**示例**：

```python
# 设置简单的键值对
await redis.set("username", "张三")

# 设置带过期时间的键值对（30秒后自动删除）
await redis.set("session_token", "abc123xyz", expire=30)

# 设置数字
await redis.set("user_count", 100)

# 设置Python对象（会自动序列化）
await redis.set("user:1001", {"name": "张三", "age": 25})
```

**实际应用场景**：

- 缓存用户会话信息
- 存储配置信息
- 缓存API响应
- 计数器

## 2 **.hset** - 设置哈希字段

```python
await redis_client.hset(key, field, value)
# 或批量设置
await redis_client.hmset(key, {"field1": "value1", "field2": "value2"})
```

**含义**：在哈希结构中设置一个字段的值

**参数**：

- `key`: 哈希的键名
- `field`: 字段名
- `value`: 字段值

**示例**：

```python
# 设置单个字段
await redis.hset("user:1001", "name", "张三")

# 批量设置多个字段
await redis.hmset("user:1001", {
    "name": "张三",
    "age": 25,
    "email": "zhangsan@example.com",
    "city": "北京"
})
```

**实际应用场景**：

- **用户信息存储**：将用户的所有属性存储在哈希中

```python
user_data = {
    "id": 1001,
    "username": "zhangsan",
    "email": "zhangsan@example.com",
    "created_at": "2024-01-15",
    "last_login": "2024-01-20",
    "status": "active"
}
await redis.hmset("user:1001", user_data)
```

- **会话管理**：

```python
session = {
    "session_id": "abc123",
    "user_id": 1001,
    "created_at": "2024-01-15 10:00:00",
    "last_activity": "2024-01-15 10:30:00",
    "ip_address": "192.168.1.100"
}
await redis.hmset("session:abc123", session)
```

## 3  **.lpush / .rpush** - 列表推入操作

```python
await redis_client.lpush(key, *values)    # 从左侧推入
await redis_client.rpush(key, *values)    # 从右侧推入
```

**含义**：向列表的左侧或右侧推入元素

**参数**：

- `key`: 列表的键名
- `*values`: 要推入的一个或多个值

**示例**：

```python
# 从左侧推入（新元素在开头）
await redis.lpush("tasks", "task3", "task2", "task1")
# 列表顺序：["task1", "task2", "task3"]

# 从右侧推入（新元素在末尾）
await redis.rpush("messages", "msg1", "msg2", "msg3")
# 列表顺序：["msg1", "msg2", "msg3"]
```

**实际应用场景**：

- **任务队列**（使用lpush/rpush配合lpop/rpop）：

  ```python
  # 生产者：添加任务到队列
  await redis.lpush("task_queue", json.dumps({"task_id": 1, "type": "email"}))
  await redis.lpush("task_queue", json.dumps({"task_id": 2, "type": "sms"}))
  
  # 消费者：处理任务
  task = await redis.rpop("task_queue")
  if task:
      task_data = json.loads(task)
      process_task(task_data)
  ```

## 4 **.lrange** - 获取列表范围

```python
await redis_client.lrange(key, start, end)
```

**含义**：获取列表中指定范围的元素

**参数**：

- `key`: 列表的键名
- `start`: 起始索引（0表示第一个元素）
- `end`: 结束索引（-1表示最后一个元素）

**示例**：

```python
# 获取所有元素
all_items = await redis.lrange("mylist", 0, -1)

# 获取前5个元素
first_five = await redis.lrange("mylist", 0, 4)

# 获取最后3个元素
last_three = await redis.lrange("mylist", -3, -1)
```

**实际应用场景**：

- **分页查询**：

  ```python
  # 获取消息列表的第1页（每页10条）
  page = 1
  page_size = 10
  start = (page - 1) * page_size
  end = start + page_size - 1
  messages = await redis.lrange("messages", start, end)
  
  # 总消息数
  total = await redis.llen("messages")
  ```

## 5 **.sadd** - 添加集合成员

```python
await redis_client.sadd(key, *members)
```

**含义**：向集合中添加一个或多个成员（集合会自动去重）

**参数**：

- `key`: 集合的键名
- `*members`: 要添加的一个或多个成员

**示例**：

```python
# 添加标签
await redis.sadd("article:1001:tags", "Python", "编程", "Redis")

# 添加用户到群组
await redis.sadd("group:developers:members", "user:1001", "user:1002", "user:1003")

# 添加收藏
await redis.sadd("user:1001:favorites", "product:P001", "product:P002")
```

## 6 **.smembers** - 获取集合所有成员

```python
await redis_client.smembers(key)
```

**含义**：获取集合中的所有成员

**参数**：

- `key`: 集合的键名

**示例**：

```python
# 获取所有标签
tags = await redis.smembers("article:1001:tags")

# 获取群组所有成员
members = await redis.smembers("group:developers:members")

# 获取用户所有收藏
favorites = await redis.smembers("user:1001:favorites")
```

## 7 **.delete** - 删除键

```python
await redis_client.delete(*keys)
```

**含义**：删除一个或多个键

**参数**：

- `*keys`: 要删除的一个或多个键名

**示例**：

```python
# 删除单个键
await redis.delete("user:1001:name")

# 删除多个键
await redis.delete("user:1001:name", "user:1001:age", "user:1001:email")

# 删除整个用户数据
user_keys = ["user:1001:name", "user:1001:age", "user:1001:profile"]
await redis.delete(*user_keys)
```

## 8 .scard- 获取集合成员数量

```python
count = await redis.scard(key)
"""
返回结果:
返回集合中的成员数量（整数）
如果键不存在或不是集合类型，返回 0
"""
```

## 9 .exists - 检查键是否存在

```python
await redis.exists(key)  # 检查单个键
await redis.exists(key1, key2, key3)  # 检查多个键
"""
返回结果:
单个键：返回 1（存在）或 0（不存在）
多个键：返回存在的键的数量
"""
```



## 数据结构对比总结

| 命令              | 数据结构 | 特点                       | 适用场景                 |
| :---------------- | :------- | :------------------------- | :----------------------- |
| **.set**          | 字符串   | 简单的键值对               | 缓存、配置、计数器       |
| **.hset**         | 哈希     | 字段-值映射，适合存储对象  | 用户信息、会话、商品详情 |
| **.lpush/.rpush** | 列表     | 有序、可重复、支持两端操作 | 队列、时间线、历史记录   |
| **.sadd**         | 集合     | 无序、不重复、支持集合运算 | 标签、好友关系、投票系统 |
| **.zadd**         | 有序集合 | 有序、不重复、带分数       | 排行榜、优先级队列       |

## 批量操作提高性能

```python
# 使用管道批量操作
async with redis.pipeline() as pipe:
    pipe.set("key1", "value1")
    pipe.set("key2", "value2")
    pipe.hset("user:1001", "name", "张三")
    results = await pipe.execute()
```

## 知识点

- 过期的键，通过.smembers .scard 或者 .exists还能查到么？

  | 命令             | 过期键的行为   | 返回结果               |
  | :--------------- | :------------- | :--------------------- |
  | **`.exists`**    | ❌ **不能**查到 | 返回 `0`（不存在）     |
  | **`.scard`**     | ❌ **不能**查到 | 返回 `0`（集合不存在） |
  | **`.smembers`**  | ❌ **不能**查到 | 返回空集合 `set()`     |
  | **所有读取命令** | ❌ **不能**查到 | 视命令返回相应空值     |
  | **所有写入命令** | ✅ **可以**覆盖 | 删除旧键，创建新键     |

