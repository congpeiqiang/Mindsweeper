┌─────────────────────────────────────────┐
│          FastAPI 请求处理流程           │
├─────────────────────────────────────────┤
│                                         │
│  1. 接收请求                            │
│  2. 执行业务逻辑                        │
│  3. 将同步函数包装为异步               │
│     ↓ asyncio.to_thread()              │
│  4. 添加到后台任务队列                 │
│     ↓ background_tasks.add_task()      │
│  5. 立即返回响应                       │
│  6. 在后台执行所有任务                 │
└─────────────────────────────────────────┘